# name: Autocoder Action Workflow

# on:
#   issues:
#     types: [opened, reopened, labeled]

# jobs:
#   code_generation:
#     runs-on: ubuntu-latest
#     if: contains(github.event.issue.labels.*.name, 'autocoder-bot')


#     steps:
#       - name: Checkout Repository
#         uses: actions/checkout@v4

#       - name: Set permissions to script and make it executable
#         run: chmod +x ./scripts/script.sh

#       - name: Generate Code with ChatGPT
#         id: generate_code
#         env:
#           GITHUB_TOKEN: ${{ secrets.TOKEN_GITHUB }}
#           OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
#           REPOSITORY: ${{ github.repository }}
#           ISSUE_NUMBER: ${{ github.event.issue.number }}
#         run: ./scripts/script.sh $GITHUB_TOKEN $REPOSITORY $ISSUE_NUMBER $OPENAI_API_KEY
      
#       - name: Upload Generated Artifact
#         uses: actions/upload-artifact@v3
#         with:
#           name: autocoder-artifact
#           path: autocoder-bot/

#       - name: Download Generated Artifact
#         uses: actions/download-artifact@v3
#         with:
#           name: autocoder-artifact
#           path: autocoder-artifact/
      
#       - name: List Files
#         run: ls -R autocoder-artifact/
      


#       - name: Commit files
#         run: |
#           git config --local user.email "actions@github.com"
#           git config --local user.name "autocoder-bot"
#           git add .
#           git commit -m "Add code snippets from issue #${{ github.event.issue.number }}" -a || echo "No changes to commit"

#       - name: Create pull request
#         if: success()
#         uses: peter-evans/create-pull-request@v6
#         with:
#           commit-message: "Add code snippets from issue #${{ github.event.issue.number }}"
#           title: "Add code snippets from issue #${{ github.event.issue.number }}"
#           body: |
#               This pull request adds code snippets from issue #${{ github.event.issue.number }}.
#           branch: "autocoder-branch-${{ github.event.issue.number }}"
#           base: "main"
#           labels: "autocoder-bot"
#           reviewers: "autocoder-bot"
#           assignees: "autocoder-bot"





## Using the AutoCoder Composite Action


name: AutoCodeGen
on:
  issues:
    types: [opened, reopened, labeled]

permissions:
  contents: write
  pull-requests: write

jobs:
  generate_code:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Generate Code with ChatGPT
        id: generate_code
        uses: pankaj892/Autocoder@main
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          # issue_label: 'autocoder'
          REPOSITORY: ${{ github.repository }}
          ISSUE_NUMBER: ${{ github.event.issue.number }}